# common usage
# nmap: get active hosts (good for LAN)
nmap -sP --min-rate 1000 -T4 ipRange | grep -Eo '([0-9]*\.){3}[0-9]*'

# nmap: get active hosts over internet on a big range
nmap -sS -F -n --min-rate 500 -T4 ipRange -oA nmap-100-ping-scan | grep -Eo '([0-9]*\.){3}[0-9]*' | sort -u

# nmap: slow scan for UDP and TCP on all ports
nmap -p- --min-rate 500 --max-retries 1 -T4 -sUS -oA fileName targetIp

# nmap: advanced scan fordetecting most of the services/os and versions
nmap --min-rate 500 -sS -sV -O -sC -iL active-hosts.txt -oA nmap-1000-ports

# nmap: grep all hosts that has the port 445 open
cat file.gnmap | grep "445/open/tcp" | cut -f2 -d " "

# nmap: path to scripts
/usr/share/nmap/scripts

# nmap: Stealth-SYN-Scan (does not contact Service), -O = operating system.
nmap -e yourInterface -sS -O targetIp

# nmap: find MySql server, UDP scan
nmap -iL targetIp-list.txt -sU -p 1434 --script=ms-sql-info

# nmap: exploit checker
nmap -v -p 445 --script smb-vuln-ms08-067 targetIp
nmap -v -p 3389 --script rdp-vuln-ms12-020 targetIp

# nmap: MSSQL scripts
nmap -n -sU --script=ms-sql-info -p 1434 targetIp
nmap -p 1434 --script ms-sql-brute --script-args userdb=user.txt,passdb=pws.txt targetIp
nmap -sS --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd="whoami",mssql.instance-port=1434 targetIp

# nmap: script category
nmap --script "http-*" targetIp
nmap --script "not intrusive" -p 80,443,445,8080

# nmap: write grepable, XML and nmap format
nmap -oA fileName targetIp

# nmap: resume stopped scan (need normal (-oN) or grepable (-oG) format)
nmap --resume fileName
